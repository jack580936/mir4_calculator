worker_processes 1;

events {
    worker_connections 1024;
}

http {
    include             /etc/nginx/mime.types;
    default_type        application/octet-stream;
    sendfile            on;
    keepalive_timeout   65;

    # Gzip Settings for better performance
    gzip on;
    gzip_disable "msie6";
    gzip_vary on;
    gzip_proxied any;
    gzip_comp_level 6;
    gzip_buffers 16 8k;
    gzip_http_version 1.1;
    gzip_types text/plain text/css application/json application/javascript text/xml application/xml application/xml+rss text/javascript;

    server {
        listen 80;
        server_name localhost;

        # Location block for your Vue app with base path '/mir4_calculator/'
        location /mir4_calculator/ {
            # The alias should point to the directory where your `dist` files are located.
            # In a typical Docker setup, you copy the contents of the `dist` folder here.
            alias /usr/share/nginx/html/;

            # This is the key for SPA routing.
            # It tries to find the file, then a directory, and falls back to index.html.
            try_files $uri $uri/ /mir4_calculator/index.html;
        }

        # Redirect root requests to your app's base path for a better user experience
        location = / {
            return 301 /mir4_calculator/;
        }

        # Optional: Define custom error pages
        error_page   500 502 503 504  /50x.html;
        location = /50x.html {
            root   /usr/share/nginx/html;
        }
    }
}
